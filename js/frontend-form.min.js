(function(e){var t={init:function(){e(".wpuf-form").on("click","img.wpuf-clone-field",this.cloneField);e(".wpuf-form").on("click","img.wpuf-remove-field",this.removeField);e("#wpuf-form-add").on("submit",this.handleForm)},cloneField:function(t){t.preventDefault();var n=e(this).closest("tr"),r=n.clone();r.find("input").val("");r.find(":checked").attr("checked","");n.after(r)},removeField:function(){var t=e(this).closest("tr"),n=t.siblings().andSelf().length;n>1&&t.remove()},handleForm:function(n){n.preventDefault();var r=e(this),i,s="",o=!1,u=[];t.removeErrors(r);t.removeErrorNotice(r);var a=r.find('[data-required="yes"]');a.each(function(n,r){var i=e(r).data("type");val="";switch(i){case"rich":var s=e(r).data("id");val=e.trim(tinyMCE.get(s).getContent());if(val===""){o=!0;t.markError(r)}break;case"textarea":case"text":val=e.trim(e(r).val());if(val===""){o=!0;t.markError(r)}break;case"select":val=e(r).val();if(!val||val==="-1"){o=!0;t.markError(r)}break;case"multiselect":val=e(r).val();if(val===null||val.length===0){o=!0;t.markError(r)}break;case"tax-checkbox":var u=e(r).children().find("input:checked").length;if(!u){o=!0;t.markError(r)}break;case"radio":var u=e(r).parent().find("input:checked").length;if(!u){o=!0;t.markError(r)}break;case"file":var u=e(r).next("ul").children().length;if(!u){o=!0;t.markError(r)}}});r.find("input.url").each(function(n,r){if(e(r).val()!==""&&!t.isValidURL(e(r).val())){o=!0;t.markError(r)}});r.find("input.email").each(function(n,r){if(e(r).val()!==""&&!t.isValidEmail(e(r).val())){o=!0;t.markError(r)}});if(o){t.addErrorNotice(r);return!1}r.find("li.wpuf-submit").append('<span class="wpuf-loading"></span>');r.find("input[type=submit]").addClass("button-primary-disabled");e.post(wpuf_frontend.ajaxurl,e(this).serialize(),function(e){e.success?window.location=e.redirect_to:alert(e.error);r.find("input[type=submit]").removeClass("button-primary-disabled");r.find("span.wpuf-loading").remove()})},addErrorNotice:function(t){e(t).find("li.wpuf-submit").append('<div class="wpuf-errors">'+wpuf_frontend.error_message+"</div>")},removeErrorNotice:function(t){e(t).find(".wpuf-errors").remove()},markError:function(t){e(t).closest("li").addClass("has-error");e(t).focus()},removeErrors:function(t){e(t).find(".has-error").removeClass("has-error")},isValidEmail:function(e){var t=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return t.test(e)},isValidURL:function(e){var t=new RegExp("^(http://www.|https://www.|ftp://www.|www.|http://|https://){1}([0-9A-Za-z]+.)");return t.test(e)}};e(function(){t.init()})})(jQuery);